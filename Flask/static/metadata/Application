{
    "type": "Ext.app.Application",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "models": [
            "specialite",
            "chantier"
        ],
        "stores": [
            "specialites",
            "employes_hours",
            "chantiers_hours",
            "employes_logHours"
        ],
        "views": [
            "appViewport",
            "sousTraitantsContextMenu",
            "editChantierWindow",
            "loginWindow"
        ],
        "appFolder": "dalpeApp",
        "appProperty": "dalpeApp",
        "controllers": [
            "sousTraitants",
            "employes",
            "clients",
            "chantiers",
            "loginWindow",
            "global",
            "logHours"
        ],
        "name": "dalpeApp"
    },
    "designerId": "application",
    "cn": [
        {
            "type": "fixedfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "launch",
                "implHandler": [
                    "function confirm_exit(e) {",
                    "    if(!e) e = window.event;",
                    "",
                    "    e.cancelBubble = true;",
                    "    e.returnValue = 'Etes vous sur de vouloir quitter l\\'application?'; ",
                    "",
                    "    if (e.stopPropagation) {",
                    "        e.stopPropagation();",
                    "        e.preventDefault();",
                    "    }",
                    "}",
                    "window.onbeforeunload=confirm_exit;",
                    "",
                    "document.oncontextmenu = function(){return false;}; //permet de ne pas ouvrir le context menu de windows",
                    "",
                    "var allStores = Ext.StoreManager.items;",
                    "",
                    "for (var i in allStores)",
                    "{",
                    "    var currentStore = allStores[i];",
                    "    if (currentStore.proxy && currentStore.proxy.sortParam)",
                    "    {",
                    "        currentStore.proxy.sortParam = undefined;",
                    "    }",
                    "}",
                    "",
                    "",
                    "var loginController = dalpeApp.getApplication().getController('loginWindow');",
                    "",
                    "if (loginController.isLogged()) {",
                    "    dalpeApp.view.appViewport.create();",
                    "    var user = loginController.getUserLogged();",
                    "    Ext.ComponentQuery.query('#userLogged')[0].setText('Utilisateur Connect√©: ' + user);",
                    "    return;",
                    "}",
                    "",
                    "loginController.isFirstUser()",
                    ".then(function(response){",
                    "    if (response === true) {",
                    "        if (response === true) {",
                    "            dalpeApp.view.appViewport.create();",
                    "            alert('Vous etes le premier utilisateur a vous connecter,'+",
                    "            'allez dans l\\'onglet employes pour creer votre fiche et celle des autres employes');",
                    "        }",
                    "    }",
                    "    else {",
                    "        //On affiche la login window",
                    "        dalpeApp.view.loginWindow.create();",
                    "    }",
                    "});",
                    ""
                ]
            },
            "designerId": "5cbb8634-3149-4cdf-b1d1-05fc951f7373"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "createRecord",
                "designer|params": [
                    "model",
                    "data"
                ],
                "implHandler": [
                    "var me =this;",
                    "var promise = new RSVP.Promise(function(resolve, reject) {",
                    "    Ext.Ajax.request({",
                    "        url: ('/api/model/'+model),",
                    "        method:'POST',",
                    "        jsonData: data,",
                    "        success: function(response){",
                    "            var jsonData = Ext.JSON.decode(response.responseText);",
                    "            var myModel = me.getModel(model);",
                    "            var record = new myModel(jsonData);",
                    "            console.log(record);",
                    "        }",
                    "    });",
                    "});",
                    "",
                    "return promise;"
                ]
            },
            "designerId": "697ee51b-f84d-4a7e-a138-4c67d83dcb13"
        }
    ]
}